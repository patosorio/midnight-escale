{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/firebase/admin.ts"],"sourcesContent":["import { initializeApp, getApps, cert } from 'firebase-admin/app'\nimport { getAuth } from 'firebase-admin/auth'\n\n// Initialize Firebase Admin SDK\nif (!getApps().length) {\n  initializeApp({\n    credential: cert({\n      projectId: process.env.FIREBASE_PROJECT_ID,\n      clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\n      privateKey: process.env.FIREBASE_PRIVATE_KEY?.replace(/\\\\n/g, '\\n'),\n    }),\n  })\n}\n\nexport const adminAuth = getAuth()\n\n/**\n * Verify Firebase ID token\n */\nexport async function verifyIdToken(token: string) {\n  try {\n    const decodedToken = await adminAuth.verifyIdToken(token)\n    return decodedToken\n  } catch (error) {\n    console.error('Error verifying token:', error)\n    throw new Error('Invalid token')\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,gCAAgC;AAChC,IAAI,CAAC,CAAA,GAAA,uKAAA,CAAA,UAAO,AAAD,IAAI,MAAM,EAAE;IACrB,CAAA,GAAA,uKAAA,CAAA,gBAAa,AAAD,EAAE;QACZ,YAAY,CAAA,GAAA,uKAAA,CAAA,OAAI,AAAD,EAAE;YACf,WAAW,QAAQ,GAAG,CAAC,mBAAmB;YAC1C,aAAa,QAAQ,GAAG,CAAC,qBAAqB;YAC9C,YAAY,QAAQ,GAAG,CAAC,oBAAoB,EAAE,QAAQ,QAAQ;QAChE;IACF;AACF;AAEO,MAAM,YAAY,CAAA,GAAA,wKAAA,CAAA,UAAO,AAAD;AAKxB,eAAe,cAAc,KAAa;IAC/C,IAAI;QACF,MAAM,eAAe,MAAM,UAAU,aAAa,CAAC;QACnD,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,MAAM,IAAI,MAAM;IAClB;AACF"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { verifyIdToken } from '@/lib/firebase/admin'\n\nexport async function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl\n\n  // Check if the request is for admin routes or protected API routes\n  const isAdminRoute = pathname.startsWith('/admin')\n  const isProtectedApiRoute = pathname.startsWith('/api/upload-image') || pathname.startsWith('/api/delete-image')\n  \n  // Allow login page to pass through\n  if (pathname === '/admin/login') {\n    return NextResponse.next()\n  }\n\n  // For admin routes and protected API routes, check authentication\n  if (isAdminRoute || isProtectedApiRoute) {\n    // Get the Firebase ID token from cookies\n    const token = request.cookies.get('firebase-auth-token')?.value\n    \n    if (!token) {\n      // Redirect to login for admin routes\n      if (isAdminRoute) {\n        return NextResponse.redirect(new URL('/admin/login', request.url))\n      }\n      // Return 401 for API routes\n      if (isProtectedApiRoute) {\n        return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n      }\n    }\n\n    // Verify the token using Firebase Admin SDK\n    try {\n      const decodedToken = await verifyIdToken(token!)\n      if (!decodedToken) {\n        throw new Error('Invalid token')\n      }\n    } catch (error) {\n      if (isAdminRoute) {\n        return NextResponse.redirect(new URL('/admin/login', request.url))\n      }\n      if (isProtectedApiRoute) {\n        return NextResponse.json({ error: 'Invalid token' }, { status: 401 })\n      }\n    }\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\n    '/admin/:path*',\n    '/api/upload-image',\n    '/api/delete-image'\n  ]\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,mEAAmE;IACnE,MAAM,eAAe,SAAS,UAAU,CAAC;IACzC,MAAM,sBAAsB,SAAS,UAAU,CAAC,wBAAwB,SAAS,UAAU,CAAC;IAE5F,mCAAmC;IACnC,IAAI,aAAa,gBAAgB;QAC/B,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,kEAAkE;IAClE,IAAI,gBAAgB,qBAAqB;QACvC,yCAAyC;QACzC,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,wBAAwB;QAE1D,IAAI,CAAC,OAAO;YACV,qCAAqC;YACrC,IAAI,cAAc;gBAChB,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,gBAAgB,QAAQ,GAAG;YAClE;YACA,4BAA4B;YAC5B,IAAI,qBAAqB;gBACvB,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAe,GAAG;oBAAE,QAAQ;gBAAI;YACpE;QACF;QAEA,4CAA4C;QAC5C,IAAI;YACF,MAAM,eAAe,MAAM,CAAA,GAAA,gIAAA,CAAA,gBAAa,AAAD,EAAE;YACzC,IAAI,CAAC,cAAc;gBACjB,MAAM,IAAI,MAAM;YAClB;QACF,EAAE,OAAO,OAAO;YACd,IAAI,cAAc;gBAChB,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,gBAAgB,QAAQ,GAAG;YAClE;YACA,IAAI,qBAAqB;gBACvB,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAgB,GAAG;oBAAE,QAAQ;gBAAI;YACrE;QACF;IACF;IAEA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;QACA;QACA;KACD;AACH"}}]
}